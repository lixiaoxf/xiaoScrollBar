(function(f){function c(h,g){this.options=null;this.$element=null;this.init(h,g)}c.VERSION="1.0.0";c.DEFAULTS={"moveBlockLength":40,"hasButton":true,"buttonPercentum":5,"marginTop":2,"contentMoveCallBack":function(){},"blockCss":{},"backgroundCss":{},"scrollBarCss":{},"nextButtonCss":{},"prevButtonCss":{}};var b={"OPPOSITE":-1,"POSITIVE":1};c.prototype.init=function(h,g){this.$element=f(h);this.options=f.extend({},c.DEFAULTS,g);this.xiaoScrollDOM={};this.operateStatus={"isDragIng":false};this.initXiaoScrollBarView();this.initXiaoScrollBarEvent()};c.prototype.initXiaoScrollBarView=function(){this.__createScrollBar();this.__basicUIStyle();this.__configUI();this.__calculateUI();this.__synXiaoScroll()};c.prototype.__createScrollBar=function(){this.xiaoScrollDOM["wrap"]=f('<div class="xiaoScrollBarWrap"></div>');var g='<div class="xiaoScrollBar">'+'<a class="prev"></a>'+'<div class="xiaoScrollBarBackground">'+'<div class="xiaoScrollBarBlock"></div>'+"</div>"+'<a class="next"></a>'+"</div>";this.xiaoScrollDOM["scrollBar"]=f(g);this.xiaoScrollDOM["prev"]=this.xiaoScrollDOM["scrollBar"].find(".prev");this.xiaoScrollDOM["next"]=this.xiaoScrollDOM["scrollBar"].find(".next");this.xiaoScrollDOM["background"]=this.xiaoScrollDOM["scrollBar"].find(".xiaoScrollBarBackground");this.xiaoScrollDOM["block"]=this.xiaoScrollDOM["scrollBar"].find(".xiaoScrollBarBlock")};c.prototype.__synXiaoScroll=function(){this.$element.addClass("xiaoScrollBarContent");this.$element.wrap(this.xiaoScrollDOM["wrap"]);this.xiaoScrollDOM["wrap"]=this.$element.parent();this.xiaoScrollDOM["wrap"].append(this.xiaoScrollDOM["scrollBar"])};c.prototype.__configUI=function(){var i,h,g;g={"height":100-this.options["marginTop"]*2+"%","top":this.options["marginTop"]+"%"};if(!this.options["hasButton"]){i=0;h={height:100-this.options["marginTop"]*2+"%",}}else{i=this.options["buttonPercentum"]+"%";h={height:100-this.options["buttonPercentum"]*2-this.options["marginTop"]*2+"%",}}f.extend(this.options["scrollBarCss"],g);f.extend(this.options["backgroundCss"],h);this.options["nextButtonCss"]["height"]=this.options["prevButtonCss"]["height"]=i;this.xiaoScrollDOM["prev"].css(this.options["prevButtonCss"]);this.xiaoScrollDOM["next"].css(this.options["nextButtonCss"]);this.xiaoScrollDOM["block"].css(this.options["blockCss"]);this.xiaoScrollDOM["scrollBar"].css(this.options["scrollBarCss"]);this.xiaoScrollDOM["background"].css(this.options["backgroundCss"])};c.prototype.__basicUIStyle=function(){this.xiaoScrollDOM["wrap"].css({"width":this.$element.outerWidth(true),"height":this.$element.outerHeight(true),"display":this.$element.css("display"),"float":this.$element.css("float")})};c.prototype.__calculateUI=function(){this.__calculateScrollBar();this.__calculateBlock()};c.prototype.__calculateScrollBar=function(){var g=this.$element.innerHeight();this.xiaoScrollDOM["scrollBar"].css({"height":g})};c.prototype.__calculateBlock=function(){var h=this.xiaoScrollDOM["scrollBar"].find(".xiaoScrollBarBackground").innerHeight(),i=this.$element[0].scrollHeight,g=this.$element.innerHeight(),j=(g/i)*h;this.xiaoScrollDOM["block"].height(j)};c.prototype.initXiaoScrollBarEvent=function(){this.mouseScrollMoveContent();this.dragBlockMoveContent();this.scrollBtnMoveContent();this.clickScrollBcakcgroundMoveContent();this.scrollBarHideAndShow()};c.prototype.scrollBarHideAndShow=function(){var g=this;this.xiaoScrollDOM["wrap"].on("mouseenter",function(){g.show()});this.xiaoScrollDOM["wrap"].on("mouseleave",function(){g.hide()})};c.prototype.clickScrollBcakcgroundMoveContent=function(){var g=this;this.xiaoScrollDOM["background"].click(function(m){var i=m||window.event,l=i.pageY,k=g.xiaoScrollDOM["block"].innerHeight(),j,h=g.xiaoScrollDOM["background"].offset().top;j=l-h-k/2;j=g.getActualRange(j);g.xiaoScrollDOM["block"].css({"top":j});g.moveContentByBlockY()})};c.prototype.contentMoveCallBack=function(){this.options["contentMoveCallBack"]&&this.options["contentMoveCallBack"]()};c.prototype.mouseScrollMoveContent=function(){var g=this;this.$element.bind("mousewheel DOMMouseScroll",function(i){var h=e(i);g.scrollContentByBlockY(h);return false})};c.prototype.scrollBtnMoveContent=function(){var g=this;this.xiaoScrollDOM["prev"].click(function(){g.scrollContentByBlockY(b["OPPOSITE"]);return false});this.xiaoScrollDOM["next"].click(function(){g.scrollContentByBlockY(b["POSITIVE"]);return false});var h;this.xiaoScrollDOM["prev"].on("mousedown",function(){h=setInterval(function(){g.xiaoScrollDOM["prev"].click()},120);return false});this.xiaoScrollDOM["next"].on("mousedown",function(){h=setInterval(function(){g.xiaoScrollDOM["next"].click()},120);return false});this.xiaoScrollDOM["prev"].on("mouseup mouseleave",function(){clearInterval(h)});this.xiaoScrollDOM["next"].on("mouseup mouseleave",function(){clearInterval(h)})};c.prototype.dragBlockMoveContent=function(){this.operateStatus["isDragIng"]=false;var i=this.xiaoScrollDOM["block"],g,h=this;i.on("mousedown",function(k){var j=window.event||k;g=j.pageY;
    h.operateStatus["isDragIng"]=true});i.on("click",function(k){var j=window.event||k;if(j.stopPropagation){j.stopPropagation()}else{j.cancelBubble=true}});this.xiaoScrollDOM["wrap"].on("mousemove",function(o){if(h.operateStatus["isDragIng"]){var l=window.event||o,k=l.pageY,n=k-g,m=i.position().top,j=m+n;j=h.getActualRange(j);i.css({"top":j});g=k;h.moveContentByBlockY()}return false});this.xiaoScrollDOM["wrap"].on("mouseup mouseleave",function(j){h.operateStatus["isDragIng"]=false})};function e(h){var g=window.event||h;if(g.wheelDelta){return g.wheelDelta<0?b["POSITIVE"]:b["OPPOSITE"]}else{return g.detail>0?b["POSITIVE"]:b["OPPOSITE"]}}c.prototype.scrollContentByBlockY=function(i){var h=this.xiaoScrollDOM["block"].position().top,g=Math.round(i*this.options["moveBlockLength"]+h),g=this.getActualRange(g);this.moveBlock(g,"top");this.moveContentByBlockY(g)};c.prototype.moveContentByBlockY=function(j){var g,l=!j&&j!=0?this.xiaoScrollDOM["block"].position().top:j,i=this.xiaoScrollDOM["background"].innerHeight(),m=this.xiaoScrollDOM["block"].height(),h=this.$element.innerHeight(),k=this.$element[0].scrollHeight;g=Math.round((l/(i-m))*(k-h));if(g>=k-h){g=k-h}else{if(g<=0){g=0}}this.moveContent(g);this.contentMoveCallBack()};c.prototype.moveBlock=function(i,g,l){var h=this,k=this.xiaoScrollDOM["block"].data("xiaoTimer"),j=this.xiaoScrollDOM["block"];clearInterval(k);k=setInterval(function(){var m=Math.round(j.position()[g]),n=a(m,i);if(m==i||h.isStopMove()){clearInterval(k)}else{css={};css[g]=n<0?Math.ceil(m+n):Math.floor(m+n);j.css(css)}l&&l()},24);j.data("xiaoTimer",k)};c.prototype.moveContent=function(h){var g=this,i=g.$element.data("xiaoTimer");clearInterval(i);i=setInterval(function(){var k=g.$element.scrollTop();if(k==h){clearInterval(i)}else{var l=a(k,h);var j=l<0?Math.ceil(k+a(k,h)):Math.floor(k+a(k,h));g.$element.scrollTop(j)}},24);this.$element.data("xiaoTimer",i)};c.prototype.isStopMove=function(){return this.operateStatus["isDragIng"]};c.prototype.getActualRange=function(h){var g=this.xiaoScrollDOM["background"].innerHeight(),i=this.xiaoScrollDOM["block"].height();if(h>=g-i){h=g-i}else{if(h<=0){h=0}}return h};function a(i,g){var h=(g-i)/12;h=h>0?Math.ceil(h):Math.floor(h);return h}c.prototype.show=function(){this.xiaoScrollDOM["scrollBar"].stop();this.xiaoScrollDOM["scrollBar"].fadeIn()};c.prototype.hide=function(){this.xiaoScrollDOM["scrollBar"].stop();this.xiaoScrollDOM["scrollBar"].fadeOut()};function d(h){var g=h||{};new c(this,g)}f.fn.xiaoScrollBar=d;f.fn.xiaoScrollBar.Constructor=c})(jQuery);